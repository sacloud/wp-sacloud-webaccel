# wp-sacloud-webaccel

## このプラグインについて

![eye-catch.jpg](images/eye-catch.jpg)

`wp-sacloud-webaccel`は、WordPressと[さくらのクラウド ウェブアクセラレータ](https://cloud.sakura.ad.jp/specification/web-accelerator/)を連携させるためのプラグインです。

以下のような機能を持っています。

### [Cache-Controlレスポンスヘッダの出力](#cache-controlレスポンスヘッダの出力)

ウェブアクセラレータにWordPressのコンテンツをキャッシュさせるために、`Cache-Control`レスポンスヘッダを出力します。

### [APIでのキャッシュ自動削除](#apiでのキャッシュ自動削除)

WordPress上のデータ更新時に、ウェブアクセラレータのキャッシュ削除APIを呼び出してキャッシュ削除します。

例えば、記事の更新/コメントの承認などを行った場合、以下のようなページについてキャッシュ削除が行われます。
 
  - 該当記事のページ
  - ホームページ(ブログトップページ)
  - 該当記事の属するアーカイブページ
    - 年、年月、年月日アーカイブ
    - カテゴリー
    - タグ
    - その他カスタムタクソノミー
  - フィード(rss/rss2/rdf/atom)

データ更新時のキャッシュ削除については[[更新時のキャッシュ削除ルール]](Other.md#更新時のキャッシュ削除ルール)を参照してください。

### [メディアファイルのURL動的書き替え](#メディアファイルのurl動的書き替え)

ウェブアクセラレータをサブドメイン型で利用する場合のための機能です。

メディアファイルの参照元URLをウェブアクセラレータのサブドメイン(*.user.webaccel.jp)へ向けて動的に書き換えることが出来ます。

[JetPack/Photon](https://jetpack.com)などと同じく、データベース上の記事データは更新せずに、リクエスト時に動的にURLを書き換える方式です。

### [小さなフットプリント](#小さなフットプリント)
 
プラグイン導入時のWordPressデータ/ファイルへの影響が非常に小さいです。

これにより、すでに稼働しているWordPressへの導入でも安心してご利用いただけます。

なお、当プラグインを有効化することで追加/変更されるデータ/ファイルは以下の2つのみです。

  - データベース上のオプションデータテーブル(`wp_options`)へ1レコード追加
  - アップロードディレクトリ(通常は`wp-content/uploads`)へ`.htaccess`(5行だけ!)追加

もちろんこれらはプラグインを停止するとクリーンアップされます。安心してご利用ください。

### [WP-CLIのサポート](#wp-cliのサポート)
 
キャッシュのクリア処理などを[WP-CLI](https://wp-cli.org)を通じて行えます。
 
---

Next : [[インストール / Installation]](Installation.md)

---